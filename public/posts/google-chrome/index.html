<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Google Chrome Extension | Juraj Kosik</title>

<meta name="description" content="How to build simple Chrome Extension from scratch.">
    <link rel="stylesheet" href="/css/main.css">

<link rel="icon" type="image/svg+xml" href="http://localhost:1313/favicon.svg"> 
<link rel="icon" type="image/x-icon" href="http://localhost:1313/favicon.ico"> 
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon.png"> 
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32.png"> 
<link rel="icon" type="image/png" sizes="64x64" href="http://localhost:1313/favicon-64.png"> 

</head>
<body>
  <header class="py-6 border-b"><div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8 flex flex-col">
	<div class="flex items-center">
		<div class="flex items-center">
			<button class="flex items-center space-x-2 rounded-full border py-1 pr-[5px] pl-3 group bg-zinc-100 hover:bg-zinc-200 toggle-button" data-target="menu-bar">
				<svg width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
					<path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"></path>
				</svg>
				<span class="bg-blue-500 fill-white rounded-full p-1.5">
					<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="group-hover:animate-spin bi bi-egg-fried fill-white" viewBox="0 0 16 16">
						<path d="M8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"></path>
						<path d="M13.997 5.17a5 5 0 0 0-8.101-4.09A5 5 0 0 0 1.28 9.342a5 5 0 0 0 8.336 5.109 3.5 3.5 0 0 0 5.201-4.065 3.001 3.001 0 0 0-.822-5.216zm-1-.034a1 1 0 0 0 .668.977 2.001 2.001 0 0 1 .547 3.478 1 1 0 0 0-.341 1.113 2.5 2.5 0 0 1-3.715 2.905 1 1 0 0 0-1.262.152 4 4 0 0 1-6.67-4.087 1 1 0 0 0-.2-1 4 4 0 0 1 3.693-6.61 1 1 0 0 0 .8-.2 4 4 0 0 1 6.48 3.273z"></path>
					</svg>
				</span>
			</button>
			<div class="relative rounded-full py-1.5 px-6 bg-zinc-100 hover:bg-zinc-200 text-xl font-bold uppercase mx-2">
				<h2><a class="before:content-[''] before:z-10 before:top-0 before:right-0 before:left-0 before:bottom-0 before:absolute before:pointer-events-auto" href="http://localhost:1313/">Juraj Kosik</a></h2>
			</div>
		</div>
		<div class="flex items-center ml-auto">
		</div>
	</div>
  <nav id="menu-bar" class="block mt-3 close">
    <ul class="flex items-center flex flex-nowrap whitespace-nowrap overflow-x-auto space-x-4">
    <li class="my-2">
      <a class="rounded-full border px-6 py-2 bg-zinc-100 hover:bg-zinc-200" href="/">Home</a>
    </li>
    <li class="my-2">
      <a class="rounded-full border px-6 py-2 bg-zinc-100 hover:bg-zinc-200" href="/about/">About</a>
    </li>
    <li class="my-2">
      <a class="rounded-full border px-6 py-2 bg-zinc-100 hover:bg-zinc-200" href="/tags/">Tags</a>
    </li>
    </ul>
  </nav>
</div></header>
  <main class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8"><div id="breadcrumb" class="max-w-7xl mx-auto py-8">
	<ul class="flex space-x-4 text-sm text-zinc-500">
		<li class="after:content-['❯'] after:ml-4 after:opacity-30 last:after:content-none uppercase">
			<a href="http://localhost:1313/">Juraj Kosik</a>
		</li>
		<li class="after:content-['❯'] after:ml-4 after:opacity-30 last:after:content-none uppercase">
			<a href="http://localhost:1313/posts/">Posts</a>
		</li>
	</ul>
</div><div class="max-w-4xl mx-auto mb-14">

  <article class="prose lg:prose-lg mx-auto">

    <header class="not-prose">

      <h1 id="title" class="text-4xl font-bold leading-normal">Google Chrome Extension</h1>

      <div id="lead" class="my-6">

        <p class="font-bold">How to build simple Chrome Extension from scratch. </p>

      </div>

      <div id="writer" class="flex items-center space-x-4"><ul class="flex items-center space-x-4 flex-nowrap whitespace-nowrap overflow-x-auto">

          <li class="font-semibold my-2"></li>

          <li class="before:content-['•'] before:mr-2 before:opacity-50 my-2"><time datetime="2019-12-03T14:15:05&#43;07:00">December 3, 2019</time>
          </li>

          <li class="before:content-['•'] before:mr-2 before:opacity-50 my-2">
            4 min read
          </li>

        </ul></div>

    </header>

    <figure id="featureimage" class="rounded-xl aspect-video">
            <img class="rounded-lg" src="http://localhost:1313/images/chrome-extension/big_hu_f2a0206a7f0445b9.png" alt="" width="750" height="422">

    </figure>

    <div id="content" class="mb-14">
      <p>Have you been looking for a Google Chrome Extension precisely for your usecase without any luck? Have you spent searching and trying this or that alternative and still have not found the right one? If you have been considering to write your own Chrome plugin, I am sharing a brief tutorial how to create own Extension without need to go through the extensive documentation.</p>
<h2 id="a-bit-of-theory">A bit of theory</h2>
<p>Google Chrome Extensions are in fact small web pages. They utilize well-known technologies as HTML, CSS and JavaScript. JavaScript is doing the heavy lifting and talks to Chrome APIs to get more functionalities.</p>
<p>Logic of your Extension can runs in three contexts:</p>
<ol>
<li>Content context - <code>content.js</code> has access to the page&rsquo;s <a href="https://en.wikipedia.org/wiki/Document_Object_Model">DOM</a> and can inject code to the page (nice attack vector for malicious guys :) ).</li>
<li>Background context - <code>background.js</code> lives in an isolated area, intercepts browser actions and accesses Chrome APIs. Does not see the DOM.</li>
<li>Popup context - <code>popup.html</code> provides nice looking UI. Does have access to Chrome APIs similarly to <code>background.js</code>.</li>
</ol>
<p><code>Content</code> and <code>Background</code> contexts are separated and can interact by <a href="https://developer.chrome.com/extensions/messaging">Message Passing</a>. You do not always need to use all three contexts.</p>
<h2 id="task">Task</h2>
<p>Imagine an Chrome Extension which will provide UI where the customer can find various external sites which might execute scan of the domain you are currently browsing. You should have a possibility to select only the relevant ones and Chrome should remember your selection.</p>
<h2 id="file-structure">File structure</h2>
<p>We need several files.
<figure><img src="/images/chrome-extension/files.png">
</figure>
</p>
<h3 id="manifestjson">manifest.json</h3>
<p><code>manifest.json</code> contains Extension metadata, links to scripts, permission configuration and plenty of other settings. Please see <a href="https://developers.chrome.com/extensions/manifest">Chrome Docs</a> for more information.</p>
<pre tabindex="0"><code>{
  &#34;manifest_version&#34;: 2,
  &#34;name&#34;: &#34;ScanDomain&#34;,
  &#34;description&#34;: &#34;ScanDomain&#34;,
  &#34;version&#34;: &#34;0.0.1&#34;,
  &#34;icons&#34;:  {
    &#34;64&#34;: &#34;img/icon.png&#34;
  },
  &#34;browser_action&#34;: {
    &#34;default_icon&#34;: &#34;img/icon.png&#34;,
    &#34;default_title&#34;: &#34;ScanDomain&#34;,
    &#34;default_popup&#34;: &#34;popup.html&#34;
  },
  &#34;permissions&#34;: [&#34;activeTab&#34;, &#34;notifications&#34;, &#34;storage&#34;]
}
</code></pre><h3 id="popuphtml">popup.html</h3>
<p><code>popup.html</code> opens up upon clicking on the Extension icon in the browser toolbar. HTML document can be enrich by CSS and JavaScript. Usage of locally linked <code>script/popup.js</code> JavaScript is preferred.</p>
<p><em>Note: JavaScript present directly in the <code>popup.html</code> is not recommended due to <a href="https://en.wikipedia.org/wiki/Content_Security_Policy">Content Security Policy</a> limitations. CSP can be still configured in <code>manifest.json</code>. Chrome helps you here by calculating sha256 hash of your JavaScript code or suggests using the nonce for permitting your in-html JavaScript code.</em></p>
<pre tabindex="0"><code>&lt;html&gt;

&lt;head&gt;
    &lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;css/popup.css&#34;&gt;
    &lt;script src=&#34;script/popup.js&#34;&gt;&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;

    &lt;input id=&#34;check1&#34; type=&#34;checkbox&#34; name=&#34;check1&#34; value=&#34;Qualys&#34; checked&gt;
    &lt;label for=&#34;check1&#34;&gt;Qualys&lt;/label&gt;&lt;br&gt;
    &lt;input id=&#34;check2&#34; type=&#34;checkbox&#34; name=&#34;check2&#34; value=&#34;MXtoolbox&#34; checked&gt;
    &lt;label for=&#34;check2&#34;&gt;MXtoolbox&lt;/label&gt;&lt;br&gt;
    &lt;input id=&#34;check3&#34; type=&#34;checkbox&#34; name=&#34;check3&#34; value=&#34;Shodan&#34; checked&gt;
    &lt;label for=&#34;check3&#34;&gt;Shodan&lt;/label&gt;&lt;br&gt;&lt;br&gt;

    &lt;button class=&#34;btn btn-3&#34; id=&#34;launch&#34; type=&#34;button&#34; name=&#34;launch&#34;&gt;Launch ScanDomain&lt;/button&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><h3 id="popupjs">popup.js</h3>
<p><code>popup.js</code> Plays with the DOM of the <code>popup.html</code> and talks to Chrome APIs.
Please find the comment lines in the code below.</p>
<pre tabindex="0"><code>//popup.js

//setting parameters fro Chrome notification window
var options = {
    type: &#34;basic&#34;,
    title: &#34;ScanDomain&#34;,
    message: &#34;New browser tabs are opened based on selected options.&#34;,
    iconUrl: &#34;img/icon.png&#34;

};

//optional callback function when triggering Chrome notification window
function creationCallback() {
  console.log(&#34;Notification triggered&#34;);
}

//main part. Runs whenever popup.html is loaded
document.addEventListener(&#39;DOMContentLoaded&#39;, function() {

  //load and update checkbox states as stored in local Chrome storage
  chrome.storage.sync.get(&#39;check1&#39;, function (data){
    document.getElementById(&#39;check1&#39;).checked = data.check1;
  });
  chrome.storage.sync.get(&#39;check2&#39;, function (data){
    document.getElementById(&#39;check2&#39;).checked = data.check2;
  });
  chrome.storage.sync.get(&#39;check3&#39;, function (data){
    document.getElementById(&#39;check3&#39;).checked = data.check3;
  });

  //store checkbox states to local Chrome storage upon clicking Launch button
  document.getElementById(&#34;launch&#34;).onclick = function () {
    var value1 = document.getElementById(&#39;check1&#39;).checked;
    var value2 = document.getElementById(&#39;check2&#39;).checked;
    var value3 = document.getElementById(&#39;check3&#39;).checked;
    chrome.storage.sync.set({&#39;check1&#39;: value1});
    chrome.storage.sync.set({&#39;check2&#39;: value2});
    chrome.storage.sync.set({&#39;check3&#39;: value3});

    //trigger Chrome notification
    chrome.notifications.create(options, creationCallback);

    //detect domain currently browsed by the user
    chrome.tabs.query({active: true, lastFocusedWindow: true, currentWindow: true}, function (tabs) {
      var tab = tabs[0];
      var url = new URL(tab.url);
      var domain = url.hostname;
      target1 = &#34;https://www.ssllabs.com/ssltest/analyze.html?viaform=on&amp;d=&#34; + domain
      target2 = &#34;https://mxtoolbox.com/SuperTool.aspx?action=mx%3a&#34; + domain + &#34;&amp;run=toolpage&#34;
      target3 = &#34;https://www.shodan.io/search?query=&#34; + domain

      //if option checked, open new tab
      if (document.getElementById(&#39;check1&#39;).checked) {
        chrome.tabs.create({&#34;url&#34;: target1});
      }
      if (document.getElementById(&#39;check2&#39;).checked) {
        chrome.tabs.create({&#34;url&#34;: target2});
      }
      if (document.getElementById(&#39;check3&#39;).checked) {
        chrome.tabs.create({&#34;url&#34;: target3});
      }
    });

  };
});
</code></pre><h2 id="code">Code</h2>
<p>You can find the final code <a href="https://github.com/jkosik/scandomain">here</a>.</p>
<h2 id="installation">Installation</h2>
<p>In Chrome:</p>
<ol>
<li>Browse to <code>chrome://extensions/</code></li>
<li>Enable <code>Developer mode</code></li>
<li>Click on <code>Load unpacked</code> and select <code>scandomain</code> subfolder</li>
<li>Pin the Extension to the Chrome toolbar and use.</li>
</ol>
<figure><img src="/images/chrome-extension/extension.png">
</figure>



    <ul id="taxonomy" class="not-prose flex items-center space-x-4 flex-nowrap whitespace-nowrap overflow-x-auto">

      <li class="font-semibold my-4">Tags:</li>
        <li ><a class="py-2 px-6 border rounded-full hover:bg-zinc-100 active:bg-zinc-300" href="/tags/browser/">Browser</a></li>
        <li ><a class="py-2 px-6 border rounded-full hover:bg-zinc-100 active:bg-zinc-300" href="/tags/google/">Google</a></li>
    </ul>
</div>

  </article>

</div>

</main>
  <footer class="bg-zinc-100 py-10 md:py-14"><div class="max-w-7xl mx-auto px-4 md:px-6 lg:px-8">

  <div class="flex flex-wrap space-y-6 mb-4">

    <div class="w-full md:w-3/5 flex flex-col space-y-4 md:pr-8 lg:pr-10">

      <a class="flex items-center group" href="http://localhost:1313/">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="mr-2 group-hover:animate-spin" viewBox="0 0 16 16">
          <path d="M8 11a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
          <path d="M13.997 5.17a5 5 0 0 0-8.101-4.09A5 5 0 0 0 1.28 9.342a5 5 0 0 0 8.336 5.109 3.5 3.5 0 0 0 5.201-4.065 3.001 3.001 0 0 0-.822-5.216zm-1-.034a1 1 0 0 0 .668.977 2.001 2.001 0 0 1 .547 3.478 1 1 0 0 0-.341 1.113 2.5 2.5 0 0 1-3.715 2.905 1 1 0 0 0-1.262.152 4 4 0 0 1-6.67-4.087 1 1 0 0 0-.2-1 4 4 0 0 1 3.693-6.61 1 1 0 0 0 .8-.2 4 4 0 0 1 6.48 3.273z"/>
        </svg>

        <span class="text-2xl font-semibold uppercase">Juraj Kosik</span>
      </a>

      <p class="font-semibold">
        Cybersecurity, DevSecOps, AI, and Crypto.
      </p>

    </div>

    <div class="self-center flex flex-col w-full md:w-2/5">

<ul id="social-media" class="flex items-center space-x-4">
	<li>
		<a class="w-12 h-12 rounded-full bg-white hover:bg-zinc-200 flex items-center justify-center p-2" href="https://www.github.com/jkosik" target="_blank" rel="noopener noreferrer">
			<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
				  <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
			</svg>
		</a>
	</li>
	<li>
		<a class="w-12 h-12 rounded-full bg-white hover:bg-zinc-200 flex items-center justify-center p-2" href="https://www.linkedin.com/in/jkosik" target="_blank" rel="noopener noreferrer">
			<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16">
				<path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.521-1.248-1.342-1.248-.821 0-1.358.54-1.358 1.248 0 .694.521 1.248 1.327 1.248h.015zm4.908 8.212h2.4v-4.045c0-.216.016-.432.08-.586.176-.432.576-.88 1.248-.88.88 0 1.232.664 1.232 1.637v3.874h2.4v-4.146c0-2.22-1.184-3.252-2.76-3.252-1.28 0-1.845.711-2.165 1.211h.016v-1.04h-2.4c.032.672 0 7.225 0 7.225z"/>
			</svg>
		</a>
	</li>
</ul>

    </div>

  </div>

  <div class="my-8">
    <ul class="flex items-center space-x-4">
      
        <li><a class="decoration-auto hover:underline font-semibold" href="/">Home</a></li>
      
        <li><a class="decoration-auto hover:underline font-semibold" href="/about/">About</a></li>
      
        <li><a class="decoration-auto hover:underline font-semibold" href="/tags/">Tags</a></li>
      
    </ul>
  </div>

  <div class="border-t pt-4">

    <p class="text-sm">Powered by Hugo and <a href="https://github.com/fauzanmy/pehtheme-hugo" target="_blank" rel="noopener">Pehtheme</a></p>

  </div>

</div>
</footer>
      <script src="/js/insertoggle.js"></script>
</body>
</html>